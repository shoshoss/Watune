<%= turbo_stream.replace "main-content" do %>
  <%= render partial: 'posts/index', locals: { posts: @posts, pagy: @pagy, notifications: @notifications } %>
<% end %>

<%= turbo_stream.update "after-widget" do %>
  <%= render 'shared/widget', users: @recent_users %>
<% end %>

<%= turbo_stream.update "flash" do %>
  <%= render 'shared/flash_message' %>
<% end %>

<%= turbo_stream.replace "scripts" do %>
  <%= javascript_tag do %>
    document.addEventListener("turbo:load", function() {
      const category = "<%= params[:category] %>";
      if (category) {
        const event = new CustomEvent("categoryChange", { detail: { category } });
        document.dispatchEvent(event);
      }
    });
  <% end %>
<% end %>
